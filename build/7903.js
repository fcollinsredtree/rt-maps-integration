"use strict";(globalThis.webpackChunkredtree_maps_integration=globalThis.webpackChunkredtree_maps_integration||[]).push([[7903],{93683:(e,t,i)=>{i.d(t,{$B:()=>u});var s=i(71566),r=i(29985),n=i(82555),o=i(80327),a=i(16431),l=i(85464),h=i(37755),c=i(92540),d=i(21422);let u=class extends r.A{constructor(e){super(e),this._from=null,this._to=null,this._final=null,this._current=[],this._time=0,this.duration=(0,n.A)("mapview-transitions-duration"),this.effects=[]}set effect(e){if(this._get("effect")!==(e=e||"")){this._set("effect",e);try{this._transitionTo(_(e))}catch(t){this._transitionTo([]),a.A.getLogger(this).warn("Invalid Effect",{effect:e,error:t})}}}get hasEffects(){return this.transitioning||!!this.effects.length}set scale(e){this._updateForScale(e)}get transitioning(){return null!==this._to}canTransitionTo(e){try{return this.scale>0&&p(this._current,_(e),this.scale)}catch{return!1}}transitionStep(e,t){this._applyTimeTransition(e),this._updateForScale(t)}endTransitions(){this._applyTimeTransition(this.duration)}_transitionTo(e){this.scale>0&&p(this._current,e,this.scale)?(this._final=e,this._to=(0,o.o8)(e),function(e,t,i){const s=e.length>t.length?e:t,r=e.length>t.length?t:e,n=r[r.length-1],o=n?.scale??i,a=n?.effects??[];for(let e=r.length;e<s.length;e++)r.push({scale:o,effects:[...a]});for(let e=0;e<s.length;e++)r[e].scale=-1===r[e].scale?i:r[e].scale,s[e].scale=-1===s[e].scale?i:s[e].scale,(0,d.O9)(r[e].effects,s[e].effects)}(this._current,this._to,this.scale),this._from=(0,o.o8)(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=e),this._set("effects",this._current[0]?(0,o.o8)(this._current[0].effects):[])}_applyTimeTransition(e){if(!(this._to&&this._from&&this._current&&this._final))return;this._time+=e;const t=Math.min(1,this._time/this.duration);for(let e=0;e<this._current.length;e++){const i=this._current[e],s=this._from[e],r=this._to[e];i.scale=f(s.scale,r.scale,t);for(let e=0;e<i.effects.length;e++){const n=i.effects[e],o=s.effects[e],a=r.effects[e];n.interpolate(o,a,t)}}1===t&&(this._current=this._final,this._set("effects",this._current[0]?(0,o.o8)(this._current[0].effects):[]),this._from=this._to=this._final=null)}_updateForScale(e){if(this._set("scale",e),0===this._current.length)return;const t=this._current,i=this._current.length-1;let s,r,n=1;if(1===t.length||e>=t[0].scale)r=s=t[0].effects;else if(e<=t[i].scale)r=s=t[i].effects;else for(let o=0;o<i;o++){const i=t[o],a=t[o+1];if(i.scale>=e&&a.scale<=e){n=(e-i.scale)/(a.scale-i.scale),s=i.effects,r=a.effects;break}}for(let e=0;e<this.effects.length;e++)this.effects[e].interpolate(s[e],r[e],n)}};function _(e){const t=(0,c.q)(e)||[];return function(e){const t=e[0];return!!t&&"type"in t}(t)?[{scale:-1,effects:t}]:t}function p(e,t,i){return!e[0]?.effects||!t[0]?.effects||!((-1===e[0]?.scale||-1===t[0]?.scale)&&(e.length>1||t.length>1)&&i<=0)&&(0,d.mj)(e[0].effects,t[0].effects)}function f(e,t,i){return e+(t-e)*i}(0,s._)([(0,l.MZ)()],u.prototype,"_to",void 0),(0,s._)([(0,l.MZ)()],u.prototype,"duration",void 0),(0,s._)([(0,l.MZ)({value:""})],u.prototype,"effect",null),(0,s._)([(0,l.MZ)({readOnly:!0})],u.prototype,"effects",void 0),(0,s._)([(0,l.MZ)({readOnly:!0})],u.prototype,"hasEffects",null),(0,s._)([(0,l.MZ)({value:0})],u.prototype,"scale",null),(0,s._)([(0,l.MZ)({readOnly:!0})],u.prototype,"transitioning",null),u=(0,s._)([(0,h.$)("esri.layers.effects.EffectView")],u)},37903:(e,t,i)=>{i.d(t,{m:()=>a});var s=i(93924),r=i(93683),n=i(2005),o=i(52080);class a extends n.q{constructor(){super(...arguments),this._childrenSet=new Set,this._needsSort=!1,this._children=[],this._effectView=null,this._highlightOptions=null,this._highlightGradient=null}get blendMode(){return this._blendMode}set blendMode(e){this._blendMode=e,this.requestRender()}get children(){return this._children}get clips(){return this._clips}set clips(e){this._clips=e,this.children.forEach((t=>t.clips=e))}get computedEffects(){return this._effectView?.effects??null}get effect(){return this._effectView?.effect??""}set effect(e){(this._effectView||e)&&(this._effectView||(this._effectView=new r.$B),this._effectView.effect=e,this.requestRender())}get highlightOptions(){return this._highlightOptions}set highlightOptions(e){if(!e)return this._highlightOptions=null,void(this._highlightGradient&&(this._highlightGradient.destroy(),this._highlightGradient=null,this.requestRender()));this._highlightOptions?.equals(e)||(this._highlightOptions=e,this._highlightGradient=(0,o.u4)(this._highlightGradient,e),this.requestRender())}get hasBlending(){return!!this.blendMode}get hasHighlight(){return this.children.some((e=>e.hasHighlight))}get hasLabels(){return this.children.some((e=>e.hasLabels))}get requiresDedicatedFBO(){return this.children.some((e=>"blendMode"in e&&e.blendMode&&"normal"!==e.blendMode))}updateTransitionProperties(e,t){super.updateTransitionProperties(e,t),this._effectView&&(this._effectView.transitionStep(e,t),this._effectView.transitioning&&this.requestRender())}doRender(e){const t=this.createRenderParams(e),{painter:i}=t;i.beforeRenderLayer(t,this._clips?.length?255:0,this.computedOpacity),this.renderChildren(t),i.afterRenderLayer(t,this.computedOpacity)}addChild(e){return this.addChildAt(e,this.children.length)}addChildAt(e,t=this.children.length){if(!e)return e;if(this.contains(e))return e;this._needsSort=!0;const i=e.parent;return i&&i!==this&&i.removeChild(e),t>=this.children.length?this.children.push(e):this.children.splice(t,0,e),this._childrenSet.add(e),e.parent=this,e.stage=this.stage,this!==this.stage&&(e.clips=this.clips),this.requestRender(),e}contains(e){return this._childrenSet.has(e)}endTransitions(){super.endTransitions(),this._effectView&&(this._effectView.endTransitions(),this.requestRender())}removeAllChildren(){this._childrenSet.clear(),this._needsSort=!0;for(const e of this.children)this!==this.stage&&(e.clips=null),e.stage=null,e.parent=null;this.children.length=0}removeChild(e){return this.contains(e)?this.removeChildAt(this.children.indexOf(e)):e}removeChildAt(e){if(e<0||e>=this.children.length)return null;this._needsSort=!0;const t=this.children.splice(e,1)[0];return this._childrenSet.delete(t),this!==this.stage&&(t.clips=null),t.stage=null,t.parent=null,t}sortChildren(e){this._needsSort&&(this.children.sort(e),this._needsSort=!1)}beforeRender(e){super.beforeRender(e);for(const t of this.children)t.beforeRender(e)}afterRender(e){super.afterRender(e);for(const t of this.children)t.afterRender(e)}_createTransforms(){return{displayViewScreenMat3:(0,s.vt)()}}onAttach(){super.onAttach();const e=this.stage;for(const t of this.children)t.stage=e}onDetach(){super.onDetach();for(const e of this.children)e.stage=null}renderChildren(e){for(const t of this.children)t.processRender(e)}createRenderParams(e){return{...e,requireFBO:this.requiresDedicatedFBO,blendMode:this.blendMode,effects:this.computedEffects,globalOpacity:e.globalOpacity*this.computedOpacity,inFadeTransition:this.inFadeTransition,highlightGradient:this._highlightGradient||e.highlightGradient}}}},2005:(e,t,i)=>{i.d(t,{q:()=>o});var s=i(71446),r=i(82555),n=i(68617);class o extends s.A{constructor(){super(...arguments),this._fadeOutResolver=null,this._fadeInResolver=null,this._clips=null,this.computedVisible=!0,this.computedOpacity=1,this.fadeTransitionEnabled=!1,this.inFadeTransition=!1,this._isReady=!1,this._opacity=1,this.parent=null,this._stage=null,this._visible=!0}get clips(){return this._clips}set clips(e){this._clips=e,this.requestRender()}get isReady(){return this._isReady}get opacity(){return this._opacity}set opacity(e){this._opacity!==e&&(this._opacity=Math.min(1,Math.max(e,0)),this.requestRender())}get stage(){return this._stage}set stage(e){if(this._stage===e)return;const t=this._stage;this._stage=e,e?this._stage?.untrashDisplayObject(this)||(this.onAttach(),this.emit("attach")):t?.trashDisplayObject(this)}get transforms(){return this._getTransforms()}_getTransforms(){return null==this._transforms&&(this._transforms=this._createTransforms()),this._transforms}get visible(){return this._visible}set visible(e){this._visible!==e&&(this._visible=e,this.requestRender())}get hasLabels(){return!1}get hasHighlight(){return!1}get hasBlending(){return!1}fadeIn(){return this._fadeInResolver||(this._fadeOutResolver&&(this._fadeOutResolver(),this._fadeOutResolver=null),this.opacity=1,this.computedOpacity=0,this.fadeTransitionEnabled=!0,this._fadeInResolver=(0,n.Tw)(),this.requestRender()),this._fadeInResolver.promise}fadeOut(){return this._fadeOutResolver||(this.opacity=0,this._fadeInResolver&&(this._fadeInResolver(),this._fadeInResolver=null),this.fadeTransitionEnabled=!0,this._fadeOutResolver=(0,n.Tw)(),this.requestRender()),this._fadeOutResolver.promise}endTransitions(){this._fadeInResolver?.(),this._fadeInResolver=null,this._fadeOutResolver?.(),this._fadeOutResolver=null,this.computedOpacity=this.visible?this.opacity:0,this.requestRender()}beforeRender(e){this.updateTransitionProperties(e.deltaTime,e.state.scale),this.setTransform(e.state)}afterRender(e){this._fadeInResolver&&this.computedOpacity===this.opacity?(this._fadeInResolver(),this._fadeInResolver=null):this._fadeOutResolver&&0===this.computedOpacity&&(this._fadeOutResolver(),this._fadeOutResolver=null)}remove(){this.parent?.removeChild(this)}setTransform(e){}processRender(e){this.stage&&this.computedVisible&&this.doRender(e)}requestRender(){this.stage&&this.stage.requestRender()}processDetach(){this._fadeInResolver&&(this._fadeInResolver(),this._fadeInResolver=null),this._fadeOutResolver&&(this._fadeOutResolver(),this._fadeOutResolver=null),this.onDetach(),this.emit("detach")}updateTransitionProperties(e,t){const i=0===(0,r.A)("mapview-transitions-duration")?0:1/(0,r.A)("mapview-transitions-duration");if(this.fadeTransitionEnabled&&0!==i){const t=this._fadeOutResolver||!this.visible?0:this.opacity,s=this.computedOpacity;if(s===t)this.computedVisible=this.visible;else{const r=e*i;this.computedOpacity=s>t?Math.max(t,s-r):Math.min(t,s+r),this.computedVisible=this.computedOpacity>0;const n=t===this.computedOpacity;this.inFadeTransition=!n,n||this.requestRender()}}else this.computedOpacity=this.opacity,this.computedVisible=this.visible}onAttach(){}onDetach(){}doRender(e){}ready(){this._isReady||(this._isReady=!0,this.emit("isReady"),this.requestRender())}}},32271:(e,t,i)=>{i.d(t,{$r:()=>o,M$:()=>a,mF:()=>n});var s=i(29880),r=i(49063);const n={selection:e=>new r.A({color:new s.A([e.color.r/2,e.color.g/2,e.color.b/2,e.color.a])}),highlight:e=>e,popup:e=>new r.A({color:new s.A([e.color.g,e.color.b,e.color.r,e.color.a])})};function o(e){if(!e)return 0;let t=1;for(const i in n){if(i===e)break;t<<=1}return t}const a=Object.keys(n)},33262:(e,t,i)=>{i.d(t,{Ci:()=>o,HQ:()=>r,No:()=>a,XK:()=>n,aY:()=>s});const s=1,r=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],n=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],o=256,a={outlineWidth:1.3,outerHaloWidth:.4,innerHaloWidth:.4,outlinePosition:0}},93540:(e,t,i)=>{var s,r,n,o,a,l,h,c,d;i.d(t,{Be:()=>a,Gn:()=>n,RI:()=>h,S5:()=>r,ch:()=>c,uC:()=>d}),function(e){e[e.FILL=0]="FILL",e[e.LINE=1]="LINE",e[e.MARKER=2]="MARKER",e[e.TEXT=3]="TEXT",e[e.LABEL=4]="LABEL"}(s||(s={})),function(e){e[e.NONE=0]="NONE",e[e.MAP=1]="MAP",e[e.LABEL=2]="LABEL",e[e.LABEL_ALPHA=4]="LABEL_ALPHA",e[e.HITTEST=8]="HITTEST",e[e.HIGHLIGHT=16]="HIGHLIGHT",e[e.CLIP=32]="CLIP",e[e.DEBUG=64]="DEBUG",e[e.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"}(r||(r={})),function(e){e[e.SIZE=0]="SIZE",e[e.COLOR=1]="COLOR",e[e.OPACITY=2]="OPACITY",e[e.ROTATION=3]="ROTATION"}(n||(n={})),function(e){e[e.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE",e[e.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE",e[e.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE",e[e.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"}(o||(o={})),function(e){e[e.SPRITE=0]="SPRITE",e[e.GLYPH=1]="GLYPH"}(a||(a={})),function(e){e[e.DEFAULT=0]="DEFAULT",e[e.SIMPLE=1]="SIMPLE",e[e.DOT_DENSITY=2]="DOT_DENSITY",e[e.OUTLINE_FILL=3]="OUTLINE_FILL",e[e.OUTLINE_FILL_SIMPLE=4]="OUTLINE_FILL_SIMPLE",e[e.HEATMAP=5]="HEATMAP",e[e.PIE_CHART=6]="PIE_CHART"}(l||(l={})),function(e){e[e.All=0]="All",e[e.Highlight=1]="Highlight",e[e.InsideEffect=2]="InsideEffect",e[e.OutsideEffect=3]="OutsideEffect"}(h||(h={})),function(e){e[e.BATCHING=0]="BATCHING",e[e.STRICT_ORDER=1]="STRICT_ORDER",e[e.STRICT_MARKERS_AND_TEXT=2]="STRICT_MARKERS_AND_TEXT"}(c||(c={})),function(e){e[e.FILL=0]="FILL",e[e.LINE=1]="LINE",e[e.MARKER=2]="MARKER",e[e.TEXT=3]="TEXT"}(d||(d={}))},96825:(e,t,i)=>{i.d(t,{Eq:()=>u,L4:()=>c,Pr:()=>E,QA:()=>g,Qu:()=>T,dJ:()=>d,r3:()=>f,vT:()=>m});var s=i(84516),r=i(18552),n=i(93540),o=i(85262);const a={color:{write:[!0,!0,!0,!0],blendMode:"composite"},depth:!1,stencil:{write:!1,test:{ref:e=>e.stencilRef,compare:o.MT.EQUAL,mask:255,op:{fail:o.eA.KEEP,zFail:o.eA.KEEP,zPass:o.eA.REPLACE}}}},l={color:{write:[!0,!0,!0,!0],blendMode:"additive"},depth:!1,stencil:!1},h={...a,color:{write:[!0,!0,!0,!0],blendMode:"delete"}};function c({pixelRatio:e,state:t,displayLevel:i,requiredLevel:r},n){const o=1/2**(i-n.key.level),a=1/2**(r-n.key.level);return{displayMat3:Array.from(t.displayMat3),displayViewMat3:Array.from(t.displayViewMat3),displayViewScreenMat3:Array.from(n.transforms.displayViewScreenMat3),viewMat3:Array.from(t.viewMat3),tileMat3:Array.from(n.transforms.tileMat3),displayZoomFactor:o,requiredZoomFactor:a,tileOffset:[n.x,n.y],currentScale:t.scale,currentZoom:i,metersPerSRUnit:(0,s.GA)(t.spatialReference),rotation:t.rotation,pixelRatio:e}}function d(e){return"highlight"===e.passOptions?.type}function u(e){return"hittest"===e.passOptions?.type}function _(e){if(!u(e))return null;const{position:t,distance:i,smallSymbolDistance:s,smallSymbolSizeThreshold:r}=e.passOptions;return{position:t,distance:i,smallSymbolDistance:s,smallSymbolSizeThreshold:r}}function p(e){if(!d(e))return null;const{activeReasons:t,highlightAll:i}=e.passOptions;return{activeReasons:t,highlightAll:i?1:0}}function f(e,t,i){const s={};for(const r in i)i[r]instanceof Function?s[r]=i[r](e,t):s[r]=i[r];return s}function g(e,t){const{attributeView:i,context:s}=e;return{storage:i.getUniforms(s),view:c(e,t),hittestRequest:_(e),highlight:p(e)}}function m(e){return{inside:e.selection===n.RI.InsideEffect,outside:e.selection===n.RI.OutsideEffect}}function T(e){return u(e)?l:d(e)&&"clear"===e.passOptions.stepType?h:a}function E(e){const{row:t,col:i}=e.key,s=i*r.CQ,n=t*r.CQ;return{tileOffsetFromLocalOrigin:[s%r.YV,n%r.YV],maxIntsToLocalOrigin:[Math.floor(s/r.YV),Math.floor(n/r.YV)]}}},52080:(e,t,i)=>{i.d(t,{H_:()=>T,u4:()=>E,lB:()=>R,eh:()=>m});var s=i(76295),r=i(16431),n=i(32271),o=i(18552),a=i(33262),l=i(85262),h=i(34124),c=i(98770);const d=()=>r.A.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient"),u=[0,0,0,0];class _{constructor(){this.type="single",this._convertedHighlightOptions={fillColor:[.2*.75,.6*.75,.675,.75],outlineColor:[.2*.9,.54,.81,.9],outlinePosition:a.No.outlinePosition,outlineWidth:a.No.outlineWidth,innerHaloWidth:a.No.innerHaloWidth,outerHaloWidth:a.No.outerHaloWidth},this._shadeTexChanged=!0,this._texelData=new Uint8Array(4*a.Ci),this._minMaxDistance=[0,0]}setHighlightOptions(e){const t=this._convertedHighlightOptions;!function(e,t){t.fillColor[0]=e.color.r/255,t.fillColor[1]=e.color.g/255,t.fillColor[2]=e.color.b/255,t.fillColor[3]=e.color.a,e.haloColor?(t.outlineColor[0]=e.haloColor.r/255,t.outlineColor[1]=e.haloColor.g/255,t.outlineColor[2]=e.haloColor.b/255,t.outlineColor[3]=e.haloColor.a):(t.outlineColor[0]=t.fillColor[0],t.outlineColor[1]=t.fillColor[1],t.outlineColor[2]=t.fillColor[2],t.outlineColor[3]=t.fillColor[3]),t.fillColor[3]*=e.fillOpacity,t.outlineColor[3]*=e.haloOpacity,t.fillColor[0]*=t.fillColor[3],t.fillColor[1]*=t.fillColor[3],t.fillColor[2]*=t.fillColor[3],t.outlineColor[0]*=t.outlineColor[3],t.outlineColor[1]*=t.outlineColor[3],t.outlineColor[2]*=t.outlineColor[3],t.outlineWidth=a.No.outlineWidth,t.outerHaloWidth=a.No.outerHaloWidth,t.innerHaloWidth=a.No.innerHaloWidth,t.outlinePosition=a.No.outlinePosition}(e,t);const i=t.outlinePosition-t.outlineWidth/2-t.outerHaloWidth,s=t.outlinePosition-t.outlineWidth/2,r=t.outlinePosition+t.outlineWidth/2,n=t.outlinePosition+t.outlineWidth/2+t.innerHaloWidth,o=Math.sqrt(Math.PI/2)*a.aY,l=Math.abs(i)>o?Math.round(10*(Math.abs(i)-o))/10:0,h=Math.abs(n)>o?Math.round(10*(Math.abs(n)-o))/10:0;let c;l&&!h?d().error("The outer rim of the highlight is "+l+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!l&&h?d().error("The inner rim of the highlight is "+h+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):l&&h&&d().error("The highlight is "+Math.max(l,h)+"px away from the edge of the feature; consider reducing some width values.");const _=[void 0,void 0,void 0,void 0];function p(e,t,i){_[0]=(1-i)*e[0]+i*t[0],_[1]=(1-i)*e[1]+i*t[1],_[2]=(1-i)*e[2]+i*t[2],_[3]=(1-i)*e[3]+i*t[3]}const{_texelData:f}=this;for(let e=0;e<a.Ci;++e)c=i+e/(a.Ci-1)*(n-i),c<i?(_[0]=0,_[1]=0,_[2]=0,_[3]=0):c<s?p(u,t.outlineColor,(c-i)/(s-i)):c<r?[_[0],_[1],_[2],_[3]]=t.outlineColor:c<n?p(t.outlineColor,t.fillColor,(c-r)/(n-r)):[_[0],_[1],_[2],_[3]]=t.fillColor,f[4*e]=255*_[0],f[4*e+1]=255*_[1],f[4*e+2]=255*_[2],f[4*e+3]=255*_[3];this._minMaxDistance[0]=i,this._minMaxDistance[1]=n,this._shadeTexChanged=!0}applyHighlightOptions(e,t){if(!this._shadeTex){const t=new c.R;t.wrapMode=l.pF.CLAMP_TO_EDGE,t.width=a.Ci,t.height=1,this._shadeTex=new h.g(e,t)}this._shadeTexChanged&&(this._shadeTex.updateData(0,0,0,a.Ci,1,this._texelData),this._shadeTexChanged=!1),e.bindTexture(this._shadeTex,o.CR),t.setUniform2fv("u_minMaxDistance",this._minMaxDistance)}destroy(){this._shadeTex?.dispose(),this._shadeTex=null}getReasonsWithGradients(){return[{activeReasons:(1<<n.M$.length)-1,activeGradient:this}]}}class p{constructor(){this.type="multi";const e={};for(const t in n.mF)e[t]=new _;this.gradients=e}setHighlightOptions(e){for(const t in n.mF){const i=n.mF[t](e);this.gradients[t].setHighlightOptions(i)}}applyHighlightOptions(e,t,i){this.gradients[i].applyHighlightOptions(e,t)}destroy(){for(const e in n.mF)this.gradients[e].destroy()}getReasonsWithGradients(){let e=1;const t=[];for(const i in this.gradients){const s=this.gradients[i];t.push({activeReasons:e,activeGradient:s}),e<<=1}return t}}var f=i(96825);const g=new s.J({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});function m(e){return g.toJSON(e)}function T(e){const{bandCount:t,attributeTable:i,colormap:s,pixelType:r}=e.raster.rasterInfo;return 1===t&&(null!=i||null!=s||"u8"===r||"s8"===r)}function E(e,t){return"single"===e?.type&&t.multiHighlightEnabled&&(e.destroy(),e=null),"multi"!==e?.type||t.multiHighlightEnabled||(e.destroy(),e=null),e||(e=t.multiHighlightEnabled?new p:new _),e.setHighlightOptions(t),e}function R(e,t,i){const{painter:s,highlightGradient:r}=e,{highlight:n}=s.effects;if(!r)return;const o=e.passOptions,a=r.getReasonsWithGradients();for(let r=0;r<a.length;r++){const o={...e,passOptions:{type:"highlight",activeGradient:a[r].activeGradient,activeReasons:a[r].activeReasons,stepType:"burn",highlightAll:t}};if(n.bind(o),i(o),r<a.length-1){let s=0;for(let e=r+1;e<a.length;e++)s|=a[e].activeReasons;i({...e,passOptions:{type:"highlight",activeGradient:a[r].activeGradient,activeReasons:s,stepType:"clear",highlightAll:t}})}const l={...e,passOptions:{type:"highlight",activeGradient:a[r].activeGradient,activeReasons:a[r].activeReasons,stepType:"draw",highlightAll:t}};s.setPipelineState((0,f.Qu)(e)),s.updatePipelineState(e.context),n.draw(l),n.unbind()}e.passOptions=o}},67330:(e,t,i)=>{var s;i.d(t,{p:()=>s}),function(e){e[e.Texture=0]="Texture",e[e.RenderBuffer=1]="RenderBuffer"}(s||(s={}))},34124:(e,t,i)=>{i.d(t,{g:()=>h});var s=i(41509),r=(i(82555),i(4785)),n=i(85262),o=i(67330),a=i(98770);class l extends a.R{constructor(e,t){switch(super(),this.context=e,Object.assign(this,t),this.internalFormat){case n.H0.R16F:case n.H0.R16I:case n.H0.R16UI:case n.H0.R32F:case n.H0.R32I:case n.H0.R32UI:case n.H0.R8_SNORM:case n.H0.R8:case n.H0.R8I:case n.H0.R8UI:this.pixelFormat=n.Ab.RED}}static validate(e,t){return new l(e,t)}}let h=class e{constructor(e,t=null,i=null){if(this.type=o.p.Texture,this._glName=null,this._samplingModeDirty=!1,this._wrapModeDirty=!1,this._wasImmutablyAllocated=!1,"context"in e)this._descriptor=e,i=t;else{const i=l.validate(e,t);if(!i)throw new s.A("Texture descriptor invalid");this._descriptor=i}this._descriptor.target===n.Ap.TEXTURE_CUBE_MAP?this._setDataCubeMap(i):this.setData(i)}get glName(){return this._glName}get descriptor(){return this._descriptor}get usedMemory(){return(0,a.e)(this._descriptor)}get isDirty(){return this._samplingModeDirty||this._wrapModeDirty}dispose(){this._glName&&this._descriptor.context.instanceCounter.decrement(n.vt.Texture,this),this._descriptor.context.gl&&this._glName&&(this._descriptor.context.unbindTexture(this),this._descriptor.context.gl.deleteTexture(this._glName),this._glName=null)}release(){this.dispose()}resize(e,t){const i=this._descriptor;if(i.width!==e||i.height!==t){if(this._wasImmutablyAllocated)throw new s.A("Immutable textures can't be resized!");i.width=e,i.height=t,this._descriptor.target===n.Ap.TEXTURE_CUBE_MAP?this._setDataCubeMap(null):this.setData(null)}}_setDataCubeMap(e=null){for(let t=n.Ap.TEXTURE_CUBE_MAP_POSITIVE_X;t<=n.Ap.TEXTURE_CUBE_MAP_NEGATIVE_Z;t++)this._setData(e,t)}setData(e){this._setData(e)}_setData(t,i){if(!this._descriptor.context?.gl)return;const o=this._descriptor.context.gl;(0,r.Y2)(o),this._glName||(this._glName=o.createTexture(),this._glName&&this._descriptor.context.instanceCounter.increment(n.vt.Texture,this)),void 0===t&&(t=null);const a=this._descriptor,l=i??a.target,h=f(l);null===t&&(a.width=a.width||4,a.height=a.height||4,h&&(a.depth=a.depth??1));const m=this._descriptor.context.bindTexture(this,e.TEXTURE_UNIT_FOR_UPDATES);this._descriptor.context.setActiveTexture(e.TEXTURE_UNIT_FOR_UPDATES),c(a),this._configurePixelStorage(),(0,r.Y2)(o);const T=this._deriveInternalFormat();if(p(t)){let e="width"in t?t.width:t.codedWidth,i="height"in t?t.height:t.codedHeight;const s=1;t instanceof HTMLVideoElement&&(e=t.videoWidth,i=t.videoHeight),a.width&&a.height,h&&a.depth,a.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(l,T,a.hasMipmap,e,i,s),this._texImage(l,0,T,e,i,s,t),(0,r.Y2)(o),a.hasMipmap&&this.generateMipmap(),a.width||(a.width=e),a.height||(a.height=i),h&&!a.depth&&(a.depth=s)}else{const{width:e,height:i,depth:c}=a;if(null==e||null==i)throw new s.A("Width and height must be specified!");if(h&&null==c)throw new s.A("Depth must be specified!");if(a.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(l,T,a.hasMipmap,e,i,c),_(t)){const r=t.levels,h=g(l,e,i,c),d=Math.min(h-1,r.length-1);o.texParameteri(a.target,this._descriptor.context.gl.TEXTURE_MAX_LEVEL,d);const u=T;if(!(u in n.CQ))throw new s.A("Attempting to use compressed data with an uncompressed format!");this._forEachMipmapLevel(((e,t,i,s)=>{const n=r[Math.min(e,r.length-1)];this._compressedTexImage(l,e,u,t,i,s,n)}),d)}else this._texImage(l,0,T,e,i,c,t),(0,r.Y2)(o),a.hasMipmap&&this.generateMipmap()}d(o,this._descriptor),u(o,this._descriptor),function(e,t){const i=e.capabilities.textureFilterAnisotropic;i&&e.gl.texParameterf(t.target,i.TEXTURE_MAX_ANISOTROPY,t.maxAnisotropy??1)}(this._descriptor.context,this._descriptor),(0,r.Y2)(o),this._descriptor.context.bindTexture(m,e.TEXTURE_UNIT_FOR_UPDATES)}updateData(t,i,r,n,o,a,l=0){a||console.error("An attempt to use uninitialized data!"),this._glName||console.error("An attempt to update uninitialized texture!");const h=this._descriptor,c=this._deriveInternalFormat(),{context:d,pixelFormat:u,dataType:f,target:g,isImmutable:m}=h;if(m&&!this._wasImmutablyAllocated)throw new s.A("Cannot update immutable texture before allocation!");const T=d.bindTexture(this,e.TEXTURE_UNIT_FOR_UPDATES,!0);(i<0||r<0||i+n>h.width||r+o>h.height)&&console.error("An attempt to update out of bounds of the texture!"),this._configurePixelStorage();const{gl:E}=d;l&&E.pixelStorei(E.UNPACK_SKIP_ROWS,l),p(a)?E.texSubImage2D(g,t,i,r,n,o,u,f,a):_(a)?E.compressedTexSubImage2D(g,t,i,r,n,o,c,a.levels[t]):E.texSubImage2D(g,t,i,r,n,o,u,f,a),l&&E.pixelStorei(E.UNPACK_SKIP_ROWS,0),d.bindTexture(T,e.TEXTURE_UNIT_FOR_UPDATES)}updateData3D(t,i,r,n,o,a,l,h){h||console.error("An attempt to use uninitialized data!"),this._glName||console.error("An attempt to update uninitialized texture!");const c=this._descriptor,d=this._deriveInternalFormat(),{context:u,pixelFormat:p,dataType:g,isImmutable:m,target:T}=c;if(m&&!this._wasImmutablyAllocated)throw new s.A("Cannot update immutable texture before allocation!");f(T)||console.warn("Attempting to set 3D texture data on a non-3D texture");const E=u.bindTexture(this,e.TEXTURE_UNIT_FOR_UPDATES);u.setActiveTexture(e.TEXTURE_UNIT_FOR_UPDATES),(i<0||r<0||n<0||i+o>c.width||r+a>c.height||n+l>c.depth)&&console.error("An attempt to update out of bounds of the texture!"),this._configurePixelStorage();const{gl:R}=u;if(_(h))h=h.levels[t],R.compressedTexSubImage3D(T,t,i,r,n,o,a,l,d,h);else{const e=h;R.texSubImage3D(T,t,i,r,n,o,a,l,p,g,e)}u.bindTexture(E,e.TEXTURE_UNIT_FOR_UPDATES)}generateMipmap(){const t=this._descriptor;if(!t.hasMipmap){if(this._wasImmutablyAllocated)throw new s.A("Cannot add mipmaps to immutable texture after allocation");t.hasMipmap=!0,this._samplingModeDirty=!0,c(t)}t.samplingMode===n.Cj.LINEAR?(this._samplingModeDirty=!0,t.samplingMode=n.Cj.LINEAR_MIPMAP_NEAREST):t.samplingMode===n.Cj.NEAREST&&(this._samplingModeDirty=!0,t.samplingMode=n.Cj.NEAREST_MIPMAP_NEAREST);const i=this._descriptor.context.bindTexture(this,e.TEXTURE_UNIT_FOR_UPDATES);this._descriptor.context.setActiveTexture(e.TEXTURE_UNIT_FOR_UPDATES),this._descriptor.context.gl.generateMipmap(t.target),this._descriptor.context.bindTexture(i,e.TEXTURE_UNIT_FOR_UPDATES)}clearMipmap(){const e=this._descriptor;if(e.hasMipmap){if(this._wasImmutablyAllocated)throw new s.A("Cannot delete mipmaps to immutable texture after allocation");e.hasMipmap=!1,this._samplingModeDirty=!0,c(e)}e.samplingMode===n.Cj.LINEAR_MIPMAP_NEAREST?(this._samplingModeDirty=!0,e.samplingMode=n.Cj.LINEAR):e.samplingMode===n.Cj.NEAREST_MIPMAP_NEAREST&&(this._samplingModeDirty=!0,e.samplingMode=n.Cj.NEAREST)}setSamplingMode(e){e!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=e,this._samplingModeDirty=!0)}setWrapMode(e){e!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=e,c(this._descriptor),this._wrapModeDirty=!0)}applyChanges(){const e=this._descriptor,t=e.context.gl;this._samplingModeDirty&&(d(t,e),this._samplingModeDirty=!1),this._wrapModeDirty&&(u(t,e),this._wrapModeDirty=!1)}_deriveInternalFormat(){if(null!=this._descriptor.internalFormat)return this._descriptor.internalFormat===n.Ab.DEPTH_STENCIL&&(this._descriptor.internalFormat=n.Ab.DEPTH24_STENCIL8),this._descriptor.internalFormat;switch(this._descriptor.dataType){case n.ld.FLOAT:switch(this._descriptor.pixelFormat){case n.Ab.RGBA:return this._descriptor.internalFormat=n.H0.RGBA32F;case n.Ab.RGB:return this._descriptor.internalFormat=n.H0.RGB32F;default:throw new s.A("Unable to derive format")}case n.ld.UNSIGNED_BYTE:switch(this._descriptor.pixelFormat){case n.Ab.RGBA:return this._descriptor.internalFormat=n.H0.RGBA8;case n.Ab.RGB:return this._descriptor.internalFormat=n.H0.RGB8}}return this._descriptor.internalFormat=this._descriptor.pixelFormat===n.Ab.DEPTH_STENCIL?n.Ab.DEPTH24_STENCIL8:this._descriptor.pixelFormat}_configurePixelStorage(){const e=this._descriptor.context.gl,{unpackAlignment:t,flipped:i,preMultiplyAlpha:s}=this._descriptor;e.pixelStorei(e.UNPACK_ALIGNMENT,t),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,i?1:0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s?1:0)}_texStorage(e,t,i,r,o,a){const{gl:l}=this._descriptor.context;if(!(t in n.H0))throw new s.A("Immutable textures must have a sized internal format");if(!this._descriptor.isImmutable)return;const h=i?g(e,r,o,a):1;if(f(e)){if(null==a)throw new s.A("Missing depth dimension for 3D texture upload");l.texStorage3D(e,h,t,r,o,a)}else l.texStorage2D(e,h,t,r,o);this._wasImmutablyAllocated=!0}_texImage(e,t,i,r,n,o,a){const l=this._descriptor.context.gl,h=f(e),{isImmutable:c,pixelFormat:d,dataType:u}=this._descriptor;if(c){if(null!=a){const i=a;if(h){if(null==o)throw new s.A("Missing depth dimension for 3D texture upload");l.texSubImage3D(e,t,0,0,0,r,n,o,d,u,i)}else l.texSubImage2D(e,t,0,0,r,n,d,u,i)}}else{const c=a;if(h){if(null==o)throw new s.A("Missing depth dimension for 3D texture upload");l.texImage3D(e,t,i,r,n,o,0,d,u,c)}else l.texImage2D(e,t,i,r,n,0,d,u,c)}}_compressedTexImage(e,t,i,r,n,o,a){const l=this._descriptor.context.gl,h=f(e);if(this._descriptor.isImmutable){if(null!=a)if(h){if(null==o)throw new s.A("Missing depth dimension for 3D texture upload");l.compressedTexSubImage3D(e,t,0,0,0,r,n,o,i,a)}else l.compressedTexSubImage2D(e,t,0,0,r,n,i,a)}else if(h){if(null==o)throw new s.A("Missing depth dimension for 3D texture upload");l.compressedTexImage3D(e,t,i,r,n,o,0,a)}else l.compressedTexImage2D(e,t,i,r,n,0,a)}_forEachMipmapLevel(e,t=1/0){let{width:i,height:r,depth:o,hasMipmap:a,target:l}=this._descriptor;const h=l===n.Ap.TEXTURE_3D;if(null==i||null==r||h&&null==o)throw new s.A("Missing texture dimensions for mipmap calculation");for(let s=0;e(s,i,r,o),a&&(1!==i||1!==r||h&&1!==o)&&!(s>=t);++s)i=Math.max(1,i>>1),r=Math.max(1,r>>1),h&&(o=Math.max(1,o>>1))}};function c(e){(null!=e.width&&e.width<0||null!=e.height&&e.height<0||null!=e.depth&&e.depth<0)&&console.error("Negative dimension parameters are not allowed!")}function d(e,t){let i=t.samplingMode,s=t.samplingMode;i===n.Cj.LINEAR_MIPMAP_NEAREST||i===n.Cj.LINEAR_MIPMAP_LINEAR?(i=n.Cj.LINEAR,t.hasMipmap||(s=n.Cj.LINEAR)):i!==n.Cj.NEAREST_MIPMAP_NEAREST&&i!==n.Cj.NEAREST_MIPMAP_LINEAR||(i=n.Cj.NEAREST,t.hasMipmap||(s=n.Cj.NEAREST)),e.texParameteri(t.target,e.TEXTURE_MAG_FILTER,i),e.texParameteri(t.target,e.TEXTURE_MIN_FILTER,s)}function u(e,t){"number"==typeof t.wrapMode?(e.texParameteri(t.target,e.TEXTURE_WRAP_S,t.wrapMode),e.texParameteri(t.target,e.TEXTURE_WRAP_T,t.wrapMode)):(e.texParameteri(t.target,e.TEXTURE_WRAP_S,t.wrapMode.s),e.texParameteri(t.target,e.TEXTURE_WRAP_T,t.wrapMode.t))}function _(e){return null!=e&&"type"in e&&"compressed"===e.type}function p(e){return null!=e&&!_(e)&&!function(e){return null!=e&&"byteLength"in e}(e)}function f(e){return e===n.Ap.TEXTURE_3D||e===n.Ap.TEXTURE_2D_ARRAY}function g(e,t,i,s=1){let r=Math.max(t,i);return e===n.Ap.TEXTURE_3D&&(r=Math.max(r,s)),Math.round(Math.log(r)/Math.LN2)+1}h.TEXTURE_UNIT_FOR_UPDATES=0},98770:(e,t,i)=>{i.d(t,{R:()=>n,e:()=>o});var s=i(85262),r=i(69934);class n{constructor(e=0,t=e){this.width=e,this.height=t,this.target=s.Ap.TEXTURE_2D,this.pixelFormat=s.Ab.RGBA,this.dataType=s.ld.UNSIGNED_BYTE,this.samplingMode=s.Cj.LINEAR,this.wrapMode=s.pF.REPEAT,this.maxAnisotropy=1,this.flipped=!1,this.hasMipmap=!1,this.isOpaque=!1,this.unpackAlignment=4,this.preMultiplyAlpha=!1,this.depth=1,this.isImmutable=!1}}function o(e){return e.width<=0||e.height<=0?0:Math.round(e.width*e.height*(e.hasMipmap?4/3:1)*(null==e.internalFormat?4:(0,r.IB)(e.internalFormat)))}},69934:(e,t,i)=>{i.d(t,{IB:()=>l,WH:()=>o,yu:()=>a}),i(82555);var s=i(4785),r=i(85262),n=i(23457);function o(e){const t=e.gl;switch(t.getError()){case t.NO_ERROR:return null;case t.INVALID_ENUM:return"An unacceptable value has been specified for an enumerated argument";case t.INVALID_VALUE:return"An unacceptable value has been specified for an argument";case t.INVALID_OPERATION:return"The specified command is not allowed for the current state";case t.INVALID_FRAMEBUFFER_OPERATION:return"The currently bound framebuffer is not framebuffer complete";case t.OUT_OF_MEMORY:return"Not enough memory is left to execute the command";case t.CONTEXT_LOST_WEBGL:return"WebGL context is lost"}return"Unknown error"}function a(e,t,i,r,a=0){const l=e.gl;e.bindBuffer(i);for(const i of r){const r=t.get(i.name);if(void 0===r){console.warn(`There is no location for vertex attribute '${i.name}' defined.`);continue}const h=a*i.stride;if(i.count<=4)l.vertexAttribPointer(r,i.count,i.type,i.normalized,i.stride,i.offset+h),l.enableVertexAttribArray(r),i.divisor>0&&e.gl.vertexAttribDivisor(r,i.divisor);else if(9===i.count)for(let t=0;t<3;t++)l.vertexAttribPointer(r+t,3,i.type,i.normalized,i.stride,i.offset+12*t+h),l.enableVertexAttribArray(r+t),i.divisor>0&&e.gl.vertexAttribDivisor(r+t,i.divisor);else if(16===i.count)for(let t=0;t<4;t++)l.vertexAttribPointer(r+t,4,i.type,i.normalized,i.stride,i.offset+16*t+h),l.enableVertexAttribArray(r+t),i.divisor>0&&e.gl?.vertexAttribDivisor(r+t,i.divisor);else console.error("Unsupported vertex attribute element count: "+i.count);if((0,s.en)()){const t=o(e),s=(0,n._)(i.type),r=i.offset,a=Math.round(s/r)!==s/r?`. Offset not a multiple of stride. DataType requires ${s} bytes, but descriptor has an offset of ${r}`:"";t&&console.error(`Unable to bind vertex attribute "${i.name}" with baseInstanceOffset ${h}${a}:`,t,i)}}}function l(e){switch(e){case r.Ab.ALPHA:case r.Ab.LUMINANCE:case r.Ab.RED:case r.Ab.RED_INTEGER:case r.H0.R8:case r.H0.R8I:case r.H0.R8UI:case r.H0.R8_SNORM:case r.yQ.STENCIL_INDEX8:return 1;case r.Ab.LUMINANCE_ALPHA:case r.Ab.RG:case r.Ab.RG_INTEGER:case r.H0.RGBA4:case r.H0.R16F:case r.H0.R16I:case r.H0.R16UI:case r.H0.RG8:case r.H0.RG8I:case r.H0.RG8UI:case r.H0.RG8_SNORM:case r.H0.RGB565:case r.H0.RGB5_A1:case r.yQ.DEPTH_COMPONENT16:return 2;case r.Ab.DEPTH_COMPONENT:case r.Ab.RGB:case r.Ab.RGB_INTEGER:case r.H0.RGB8:case r.H0.RGB8I:case r.H0.RGB8UI:case r.H0.RGB8_SNORM:case r.H0.SRGB8:case r.yQ.DEPTH_COMPONENT24:return 3;case r.Ab.DEPTH_STENCIL:case r.Ab.DEPTH24_STENCIL8:case r.Ab.RGBA:case r.Ab.RGBA_INTEGER:case r.H0.RGBA8:case r.H0.R32F:case r.H0.R11F_G11F_B10F:case r.H0.RG16F:case r.H0.R32I:case r.H0.R32UI:case r.H0.RG16I:case r.H0.RG16UI:case r.H0.RGBA8I:case r.H0.RGBA8UI:case r.H0.RGBA8_SNORM:case r.H0.SRGB8_ALPHA8:case r.H0.RGB9_E5:case r.H0.RGB10_A2UI:case r.H0.RGB10_A2:case r.yQ.DEPTH_STENCIL:case r.yQ.DEPTH_COMPONENT32F:case r.yQ.DEPTH24_STENCIL8:return 4;case r.yQ.DEPTH32F_STENCIL8:return 5;case r.H0.RGB16F:case r.H0.RGB16I:case r.H0.RGB16UI:return 6;case r.H0.RG32F:case r.H0.RG32I:case r.H0.RG32UI:case r.H0.RGBA16F:case r.H0.RGBA16I:case r.H0.RGBA16UI:return 8;case r.H0.RGB32F:case r.H0.RGB32I:case r.H0.RGB32UI:return 12;case r.H0.RGBA32F:case r.H0.RGBA32I:case r.H0.RGBA32UI:return 16;case r.CQ.COMPRESSED_RGB_S3TC_DXT1_EXT:case r.CQ.COMPRESSED_RGBA_S3TC_DXT1_EXT:return.5;case r.CQ.COMPRESSED_RGBA_S3TC_DXT3_EXT:case r.CQ.COMPRESSED_RGBA_S3TC_DXT5_EXT:return 1;case r.CQ.COMPRESSED_R11_EAC:case r.CQ.COMPRESSED_SIGNED_R11_EAC:case r.CQ.COMPRESSED_RGB8_ETC2:case r.CQ.COMPRESSED_SRGB8_ETC2:case r.CQ.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:case r.CQ.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:return.5;case r.CQ.COMPRESSED_RG11_EAC:case r.CQ.COMPRESSED_SIGNED_RG11_EAC:case r.CQ.COMPRESSED_RGBA8_ETC2_EAC:case r.CQ.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:return 1}return 0}},4785:(e,t,i)=>{i.d(t,{Xc:()=>h,Y2:()=>c,en:()=>l});var s=i(41509),r=i(82555),n=i(16431);const o=()=>n.A.getLogger("esri.views.webgl.checkWebGLError"),a=!!(0,r.A)("enable-feature:webgl-debug");function l(){return a}function h(){return a}function c(e){if(l()){const t=e.getError();if(t){const i=function(e,t){switch(t){case e.INVALID_ENUM:return"Invalid Enum. An unacceptable value has been specified for an enumerated argument.";case e.INVALID_VALUE:return"Invalid Value. A numeric argument is out of range.";case e.INVALID_OPERATION:return"Invalid Operation. The specified command is not allowed for the current state.";case e.INVALID_FRAMEBUFFER_OPERATION:return"Invalid Framebuffer operation. The currently bound framebuffer is not framebuffer complete when trying to render to or to read from it.";case e.OUT_OF_MEMORY:return"Out of memory. Not enough memory is left to execute the command.";case e.CONTEXT_LOST_WEBGL:return"WebGL context has been lost";default:return"Unknown error"}}(e,t),r=(new Error).stack;o().error(new s.A("webgl-error","WebGL error occurred",{message:i,stack:r}))}}}},23457:(e,t,i)=>{i.d(t,{_:()=>r});var s=i(85262);function r(e){switch(e){case s.pe.BYTE:case s.pe.UNSIGNED_BYTE:return 1;case s.pe.SHORT:case s.pe.UNSIGNED_SHORT:case s.pe.HALF_FLOAT:return 2;case s.pe.FLOAT:case s.pe.INT:case s.pe.UNSIGNED_INT:return 4}}}}]);